<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Responsive Image Compressor — Optimize & Download</title>
  <meta name="description" content="Fast, responsive client-side image compressor. Adjust compression level, resize, preview and download optimized images. Ad-ready and SEO-optimized." />
  <meta name="keywords" content="image compressor, image optimization, jpeg compressor, web image optimizer, responsive" />
  <meta name="author" content="Your Name or Company" />
  <link rel="canonical" href="https://example.com/responsive-image-compressor" />

  <!-- Open Graph for social sharing -->
  <meta property="og:title" content="Responsive Image Compressor — Optimize & Download" />
  <meta property="og:description" content="Fast, responsive client-side image compressor. Adjust compression level, resize, preview and download optimized images." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="/assets/og-image.png" />

  <!-- Schema.org JSON-LD -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Responsive Image Compressor",
    "url": "https://example.com/responsive-image-compressor",
    "description": "Client-side image compressor with adjustable quality, resize, preview and download.",
    "applicationCategory": "ImageProcessing",
    "operatingSystem": "All"
  }
  </script>

  <!-- Basic responsive CSS (no external frameworks) -->
  <style>
    :root{
      --bg:#0f172a; --card:#0b1220; --accent:#06b6d4; --muted:#94a3b8; --glass: rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;color:#e6eef6;background:linear-gradient(180deg,#071427 0%, #0f172a 100%);}
    .container{max-width:1100px;margin:28px auto;padding:20px}
    header{display:flex;align-items:center;justify-content:space-between;gap:16px;margin-bottom:18px}
    h1{font-size:1.4rem;margin:0}
    .sub{color:var(--muted);font-size:0.95rem}

    .layout{display:grid;grid-template-columns:1fr 360px;gap:18px}
    @media (max-width:900px){.layout{grid-template-columns:1fr}}

    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:16px;box-shadow:0 6px 20px rgba(2,6,23,0.6);}

    .drop{border:2px dashed rgba(255,255,255,0.06);padding:22px;border-radius:10px;text-align:center;cursor:pointer}
    .drop.dragover{border-color:var(--accent);background:rgba(6,182,212,0.03)}
    .controls{display:flex;gap:12px;flex-wrap:wrap;margin-top:12px}
    .range{display:flex;align-items:center;gap:8px}
    input[type=range]{width:220px}
    .btn{background:var(--accent);color:#021124;padding:10px 14px;border-radius:8px;border:0;cursor:pointer;font-weight:600}
    .btn.secondary{background:transparent;color:var(--accent);border:1px solid rgba(6,182,212,0.12)}

    .file-list{margin-top:12px;display:flex;flex-direction:column;gap:10px}
    .file-item{display:flex;gap:12px;align-items:center}
    .thumb{width:64px;height:64px;border-radius:8px;object-fit:cover;background:var(--glass);display:block}

    .meta{font-size:0.9rem;color:var(--muted)}

    /* right column */
    .sidebar{position:sticky;top:18px}
    .ad-slot{height:90px;border-radius:8px;background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));display:flex;align-items:center;justify-content:center;color:var(--muted);border:1px dashed rgba(255,255,255,0.03)}

    .stats{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:12px}
    .stat{background:rgba(255,255,255,0.02);padding:10px;border-radius:8px;text-align:center}

    footer{margin-top:18px;color:var(--muted);font-size:0.85rem}

    /* accessible focus styles */
    .btn:focus, .drop:focus{outline:3px solid rgba(6,182,212,0.18);outline-offset:2px}

  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>Responsive Image Compressor</h1>
        <div class="sub">Adjust quality & size, preview instantly, and download optimized images — client-side only.</div>
      </div>
      <div>
        <small class="sub">SEO-ready • Ad slots • No uploads to server</small>
      </div>
    </header>

    <main class="layout">
      <section class="card">
        <div id="dropzone" class="drop" tabindex="0" aria-label="Drop images or click to select files">
          <strong>Drag & drop images here</strong><div class="meta">or click to choose. Supports JPEG, PNG, WebP, GIF (first frame).</div>
          <input id="fileInput" type="file" accept="image/*" multiple style="display:none">
        </div>

        <div class="controls">
          <div class="range" title="Compression quality">
            <label for="quality">Quality</label>
            <input id="quality" type="range" min="10" max="100" value="80">
            <span id="qualityVal">80%</span>
          </div>

          <div class="range">
            <label for="maxWidth">Max width</label>
            <input id="maxWidth" type="number" min="100" placeholder="auto" style="width:90px">
          </div>

          <div class="range">
            <label><input type="checkbox" id="preserve" checked> Preserve format</label>
          </div>

          <div style="margin-left:auto;display:flex;gap:8px">
            <button id="processBtn" class="btn">Optimize Selected</button>
            <button id="clearBtn" class="btn secondary">Clear</button>
          </div>
        </div>

        <div class="file-list" id="fileList" aria-live="polite"></div>

        <footer>
          <div class="meta">All image processing occurs in your browser — files are not uploaded to any server. For best results, use JPEG or WebP formats for photographs.</div>
        </footer>
      </section>

      <aside class="sidebar">
        <div class="card">
          <div class="ad-slot" id="ad1">Advertisement Slot (728×90). Replace with AdSense code below.</div>

          <!-- Google AdSense placeholder: replace client & slot values in the script below -->
          <div style="margin-top:12px;font-size:0.9rem;color:var(--muted)">AdSense Integration (example):</div>
          <pre style="font-size:0.75rem;background:#081224;padding:8px;border-radius:6px;margin-top:8px;color:#9ad8e2;overflow:auto">
// Replace ADSENSE_CLIENT and ADSENSE_SLOT values in the script below
&lt;script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ADSENSE_CLIENT" crossorigin="anonymous"&gt;&lt;/script&gt;
&lt;ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ADSENSE_CLIENT"
     data-ad-slot="ADSENSE_SLOT"
     data-ad-format="auto"
     data-full-width-responsive="true"&gt;&lt;/ins&gt;
&lt;script&gt;(adsbygoogle = window.adsbygoogle || []).push({});&lt;/script&gt;
          </pre>

          <div class="stats">
            <div class="stat">
              <div class="meta">Files</div>
              <div id="count">0</div>
            </div>
            <div class="stat">
              <div class="meta">Total Saved</div>
              <div id="totalSaved">0 KB</div>
            </div>
          </div>
        </div>

        <div style="height:12px"></div>

        <div class="card">
          <h3 style="margin-top:0">Tips</h3>
          <ul class="meta">
            <li>Use 70–85% for good quality/size tradeoff for photos.</li>
            <li>Convert PNGs with many colors to JPEG or WebP for smaller sizes.</li>
            <li>For icons or screenshots, preserve PNG to avoid artifacts.</li>
          </ul>
        </div>

      </aside>
    </main>
  </div>

<script>
// ============ Configuration (replace these when embedding AdSense) ============
const ADSENSE_CLIENT = 'ca-pub-REPLACE_WITH_YOUR_CLIENT_ID'; // e.g. ca-pub-1234567890123456
const ADSENSE_SLOT = 'REPLACE_WITH_SLOT_ID'; // optional
// ============================================================================

// Basic helpers
function humanBytes(bytes){
  if(bytes < 1024) return bytes + ' B';
  if(bytes < 1024*1024) return (bytes/1024).toFixed(1) + ' KB';
  return (bytes/1024/1024).toFixed(2) + ' MB';
}

const fileInput = document.getElementById('fileInput');
const dropzone = document.getElementById('dropzone');
const fileList = document.getElementById('fileList');
const quality = document.getElementById('quality');
const qualityVal = document.getElementById('qualityVal');
const maxWidth = document.getElementById('maxWidth');
const preserve = document.getElementById('preserve');
const processBtn = document.getElementById('processBtn');
const clearBtn = document.getElementById('clearBtn');
const countEl = document.getElementById('count');
const totalSavedEl = document.getElementById('totalSaved');

let files = []; // {file, img, optimizedBlob, status}

quality.addEventListener('input', ()=> qualityVal.textContent = quality.value + '%');

// file selection
dropzone.addEventListener('click', () => fileInput.click());
fileInput.addEventListener('change', (e)=> handleFiles(e.target.files));

['dragenter','dragover'].forEach(evt=>{
  dropzone.addEventListener(evt, (e)=>{ e.preventDefault(); dropzone.classList.add('dragover'); })
});
['dragleave','drop'].forEach(evt=>{
  dropzone.addEventListener(evt, (e)=>{ e.preventDefault(); dropzone.classList.remove('dragover'); })
});

dropzone.addEventListener('drop', (e)=>{
  const dt = e.dataTransfer;
  if(dt && dt.files) handleFiles(dt.files);
});

function handleFiles(fileListIn){
  const list = Array.from(fileListIn).filter(f => f.type.startsWith('image/'));
  list.forEach(f => {
    const reader = new FileReader();
    const entry = {file: f, optimizedBlob: null, status: 'ready'};
    files.push(entry);
    reader.onload = (ev)=>{
      const img = new Image();
      img.src = ev.target.result;
      img.onload = ()=>{
        entry.img = img;
        renderFiles();
      }
      img.onerror = ()=>{
        entry.status = 'error'; renderFiles();
      }
    }
    reader.readAsDataURL(f);
  });
  renderFiles();
}

function renderFiles(){
  fileList.innerHTML = '';
  let totalSaved = 0;
  files.forEach((entry, idx)=>{
    const f = entry.file;
    const el = document.createElement('div'); el.className='file-item';

    const thumb = document.createElement('img'); thumb.className='thumb';
    if(entry.img) thumb.src = entry.img.src;
    else thumb.alt = 'loading...';

    const info = document.createElement('div');
    const name = document.createElement('div'); name.textContent = f.name;
    const meta = document.createElement('div'); meta.className='meta';
    let origSize = humanBytes(f.size);
    let statusText = entry.status === 'optimized' ? 'Optimized' : entry.status;
    let savedText = '';
    if(entry.optimizedBlob){
      const saved = f.size - entry.optimizedBlob.size;
      totalSaved += saved;
      savedText = ` — saved ${humanBytes(saved)}`;
    }
    meta.textContent = `${origSize} ${statusText}${savedText}`;

    info.appendChild(name); info.appendChild(meta);

    const actions = document.createElement('div');
    actions.style.marginLeft='auto'; actions.style.display='flex'; actions.style.gap='8px';

    const process = document.createElement('button'); process.className='btn secondary'; process.textContent='Optimize';
    process.onclick = ()=>optimizeEntry(idx);

    const download = document.createElement('a'); download.className='btn'; download.textContent='Download';
    download.style.display = entry.optimizedBlob ? 'inline-flex' : 'none';
    download.href = entry.optimizedBlob ? URL.createObjectURL(entry.optimizedBlob) : '#';
    download.download = `optimized-${f.name}`;

    actions.appendChild(process); actions.appendChild(download);

    el.appendChild(thumb); el.appendChild(info); el.appendChild(actions);
    fileList.appendChild(el);
  });
  countEl.textContent = files.length;
  totalSavedEl.textContent = humanBytes(totalSaved);
}

async function optimizeEntry(index){
  const entry = files[index];
  if(!entry || !entry.img) return;
  entry.status = 'processing'; renderFiles();
  try{
    const q = Math.max(0.1, Math.min(1, quality.value/100));
    const mw = parseInt(maxWidth.value) || entry.img.width;
    const shouldPreserve = preserve.checked;
    const result = await compressImage(entry.img, entry.file.type, q, mw, shouldPreserve);
    entry.optimizedBlob = result.blob;
    entry.status = 'optimized';
  }catch(err){
    console.error(err); entry.status = 'error';
  }
  renderFiles();
}

processBtn.addEventListener('click', async ()=>{
  if(files.length===0) return alert('No images selected');
  for(let i=0;i<files.length;i++){
    // only process those not optimized yet
    if(files[i].status !== 'optimized') await optimizeEntry(i);
  }
});

clearBtn.addEventListener('click', ()=>{ files = []; renderFiles(); fileInput.value = ''; });

// Core compression routine
function compressImage(img, originalType, qualityFraction, maxWidthPx, preserveFormat){
  return new Promise((resolve, reject)=>{
    // create canvas sized to image (respecting maxWidth)
    const scale = Math.min(1, maxWidthPx / img.width);
    const w = Math.round(img.width * scale);
    const h = Math.round(img.height * scale);
    const canvas = document.createElement('canvas');
    canvas.width = w; canvas.height = h;
    const ctx = canvas.getContext('2d');
    ctx.clearRect(0,0,w,h);
    ctx.drawImage(img, 0,0, w,h);

    // decide output mime type
    let outType = 'image/jpeg';
    if(preserveFormat){
      outType = originalType === 'image/png' ? 'image/png' : (originalType === 'image/webp' ? 'image/webp' : 'image/jpeg');
    } else {
      // convert PNGs to JPEG for photos for better compression, but preserve if transparent
      if(originalType === 'image/png'){
        // quick transparency check
        try{
          const data = ctx.getImageData(0,0,1,1).data;
          if(data[3] === 255) outType = 'image/jpeg'; else outType = 'image/png';
        }catch(e){ outType = 'image/jpeg'; }
      } else if(originalType === 'image/gif'){
        outType = 'image/jpeg';
      } else outType = originalType || 'image/jpeg';
    }

    // canvas.toBlob quality param only supported for some types; if png and quality ignored, fallback to png
    canvas.toBlob((blob)=>{
      if(!blob) return reject(new Error('Compression failed'));
      resolve({blob, width:w, height:h, type: outType});
    }, outType, qualityFraction);
  });
}

// Initialize optional AdSense insertion if user sets the constants
(function insertAdSense(){
  if(!ADSENSE_CLIENT || ADSENSE_CLIENT.includes('REPLACE')) return; // not configured
  try{
    const s = document.createElement('script');
    s.async = true; s.src = 'https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=' + encodeURIComponent(ADSENSE_CLIENT);
    s.crossOrigin = 'anonymous';
    document.head.appendChild(s);

    const ins = document.createElement('ins');
    ins.className = 'adsbygoogle';
    ins.style.display = 'block';
    ins.setAttribute('data-ad-client', ADSENSE_CLIENT);
    if(ADSENSE_SLOT && !ADSENSE_SLOT.includes('REPLACE')) ins.setAttribute('data-ad-slot', ADSENSE_SLOT);
    ins.setAttribute('data-ad-format','auto');
    ins.setAttribute('data-full-width-responsive','true');

    const ad1 = document.getElementById('ad1');
    ad1.innerHTML = '';
    ad1.appendChild(ins);

    (adsbygoogle = window.adsbygoogle || []).push({});
  }catch(e){
    console.warn('AdSense init failed', e);
  }
})();

// Accessibility: allow keyboard dropzone activation
dropzone.addEventListener('keydown', (e)=>{ if(e.key==='Enter'||e.key===' ') fileInput.click(); });

// SEO-friendly: preconnect hint for common CDN (optional)
const pre = document.createElement('link'); pre.rel='preconnect'; pre.href='https://pagead2.googlesyndication.com'; document.head.appendChild(pre);

// initial render
renderFiles();
</script>
</body>
</html>
